if (self.CavalryLogger) { CavalryLogger.start_js(["0\/oXc"]); }

__d('ReactComposerFocusModalContainer.react',['cssVar','csx','cx','fbt','ix','ReactComposerEvents','Arbiter','Bootloader','CSS','DOMQuery','Event','Image.react','Keys','React','ReactDOM','SubscriptionsHandler','Style','getViewportDimensions'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=parseInt("10px",10),n=400,o=300,p=c('React').PropTypes,q=null,r=null,s=null,t=c('React').createClass({displayName:'ReactComposerFocusModalContainer',_composerID:'',_pageRoot:null,_subscriptions:c('SubscriptionsHandler'),_interval:0,_initialized:false,propTypes:{composerID:p.string.isRequired},getInitialState:function(){return {focused:false,containerHeight:null,showConfirmDialog:false};},componentWillMount:function(){this._composerID=this.props.composerID;},componentWillUnmount:function(){this._restorePageScrollBehavior();this._subscriptions.release();},render:function(){var u=this.state.containerHeight?{height:this.state.containerHeight}:null,v=this.state.focused?c('React').createElement('div',{className:"_3o5y",onClick:this._showConfirmDialog},c('React').createElement(c('Image.react'),{alt:k._("Close"),src:l('/images/moments_app/dialog-xout.png')})):null,w=this.state.showConfirmDialog?this._renderDismissConfirmation():null;return (c('React').createElement('div',{className:"_3o5z"+(this.state.focused?' '+"_2-g0":''),style:u},c('React').createElement('div',{className:"_2-g1",onClick:this._showConfirmDialog}),c('React').createElement('div',{className:"_3o5_",ref:'container',onClick:this._enableFocus},this.props.children,v),w));},_initialize:function(){c('Bootloader').loadModules(["ReactComposerHandleUnsavedChanges","FBConfirmDialog.react","ReactComposerInit"],function(u,v,w){s=u;r=v;q=w;},'ReactComposerFocusModalContainer.react');this._subscriptions=new (c('SubscriptionsHandler'))();this._subscriptions.addSubscriptions(c('Event').listen(document.body,'keydown',function(u){if(u.keyCode===c('Keys').ESC)this._showConfirmDialog();}.bind(this)));this._subscribeComposerEvents();this._initialized=true;},_showConfirmDialog:function(){s&&s.hasUnsavedChanges(this._composerID)?this.setState({showConfirmDialog:true}):this._dismiss();},_renderDismissConfirmation:function(){return r?c('React').createElement(r,{content:k._("If you leave now, your post won't be saved."),onConfirm:this._hideConfirmDialog,onCancel:this._dismiss,onToggle:this._hideConfirmDialog,shown:true,title:k._("Finish Your Post?"),confirmButtonText:k._("Go to Post"),cancelButtonText:k._("Discard Post")}):null;},_hideConfirmDialog:function(){this.setState({showConfirmDialog:false});},_dismiss:function(){this._hideConfirmDialog();q&&q.resetComposer(this._composerID);c('Arbiter').inform('ReactComposerFocus/reset/'+this._composerID);this._disableFocus();},_subscribeComposerEvents:function(){var u=c('Arbiter').subscribe(c('ReactComposerEvents').POST_SUCCEEDED+this._composerID,this._disableFocus),v=c('Arbiter').subscribe(c('ReactComposerEvents').COMPOSER_RESET+this._composerID,function(w,x){if(x&&x.newComposerID){this._composerID=x.newComposerID;this._subscribeComposerEvents();u.remove&&u.remove();v.remove&&v.remove();}}.bind(this));this._subscriptions.addSubscriptions(u,v);},_enableFocus:function(){if(this.state.focused)return;!this._initialized&&this._initialize();this._manipulatePageScrollBehavior();var u=c('ReactDOM').findDOMNode(this.refs.container),v=u.offsetHeight+m;this.setState({focused:true,containerHeight:v});},_disableFocus:function(){if(!this.state.focused)return;this._restorePageScrollBehavior();this.setState({focused:false,containerHeight:null});},_getPageRoot:function(){if(!this._pageRoot)this._pageRoot=c('DOMQuery').scry(document.body,"._li")[0];return this._pageRoot;},_manipulatePageScrollBehavior:function(){c('CSS').addClass(this._getPageRoot(),"_2-g2");var u=function(){var v=c('getViewportDimensions')(),w=c('ReactDOM').findDOMNode(this.refs.container),x=w.offsetHeight+n,y=Math.max(v.height,x)+'px';if(c('Style').get(this._getPageRoot(),'height')!==y)c('Style').set(this._getPageRoot(),'height',y);}.bind(this);this._interval=setInterval(u,o);},_restorePageScrollBehavior:function(){c('CSS').removeClass(this._getPageRoot(),"_2-g2");c('Style').set(this._getPageRoot(),'height',null);clearInterval(this._interval);}});f.exports=t;},null);
__d('ReactComposerFocusWithModal',['ReactComposerFocusModalContainer.react','DOM','DOMContainer.react','React','ReactDOM'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={handler:function(i,j){var k=c('DOM').create('div'),l=i.parentNode;c('ReactDOM').render(c('React').createElement(c('ReactComposerFocusModalContainer.react'),{composerID:j},c('React').createElement(c('DOMContainer.react'),{display:'block'},i)),k);l.appendChild(k);},preload:function(){}};f.exports=h;},null);