if (self.CavalryLogger) { CavalryLogger.start_js(["edTtx"]); }

__d("PromptsInteractionsEventNames",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={OPEN_SELECTING_CONTENT:"open_selecting_content",OPEN_SUGGESTING_CONTENT:"open_suggesting_content",CLOSE_SUGGESTION:"close_suggestion",SELECT_SUGGESTION:"select_suggestion",CANCEL_COMPOSER:"cancel_composer",POST_PROMPT:"post_prompt",POST_WITHOUT_PROMPT:"post_without_prompt",POST_CREATED:"post_created",IMPRESSION:"impression",SHOW_SUGGESTION:"show_suggestion",HIDE_SUGGESTION:"hide_suggestion",PROMPT_AVAILABLE:"prompt_available",PROMPT_NOT_CONSIDERED:"prompt_not_considered",DEIMPRESSION:"deimpression",CLICK_TAGGER:"og-tagger-click",UNDO_DISMISS:"undo_dismiss",SHARE:"share"};},null);
__d('ReactFeedComposerXPromptInteractionsModule',['csx','cx','Arbiter','Bootloader','ReactComposerEvents','CSS','Event','PromptsInteractionsEventNames','SubscriptionsHandler','requireWeak'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={VISIBLE:'visible',HIDDEN:'hidden'},k={_subscriptions:null,_promptData:null,_promptCTAButtonClicked:null,init:function(l,m,n,o,p,q,r,s){this._promptData=r;this._promptCTAButtonClicked=false;this._subscriptions=new (c('SubscriptionsHandler'))();s&&this._onPromptCTAButtonClicked(l,o,q,r,n);this._subscriptions.addSubscriptions(c('Event').listen(p,'click',function(event){this.closePrompt(l,o);return false;}.bind(this)),c('Event').listen(o,'click',function(event){this.togglePrompt(l,o);return false;}.bind(this)),c('Event').listen(m,'click',function(event){this._onPromptCTAButtonClicked(l,o,q,r,n);}.bind(this)),c('Arbiter').subscribeOnce(c('ReactComposerEvents').POST_SUCCEEDED+q.composerID,this._cleanup.bind(this)));},_openProfilePictureSelector:function(l,m){c('Bootloader').loadModules(["XProfilePictureOverlayAsyncDialogController","AsyncRequest"],function(n,o){var p=n.getURIBuilder().setInt('selected_page_id',l.profilePictureOverlayID).setStringToStringMap('prompt_data',this._promptData).getURI();new o().setURI(p).send();c('CSS').hide(m);}.bind(this),'ReactFeedComposerXPromptInteractionsModule');},_onPromptCTAButtonClicked:function(l,m,n,o,p){this._logInteraction(c('PromptsInteractionsEventNames').OPEN_SELECTING_CONTENT);if(n.profilePictureOverlayID){this._openProfilePictureSelector(n,p);return;}if(n.trendingShareLinkData){c('Bootloader').loadModules(["ReactComposerLinkPickerLogger","ReactComposerLinkPickerDialogLoggingStore"],function(q,r){q.init(n.linkPromptVariant);q.logLinkPromptClicked();},'ReactFeedComposerXPromptInteractionsModule');this._onDialogPromptCTAButtonClicked(n);return;}else if(n.memeURLs){c('Bootloader').loadModules(["ReactComposerMemePickerLogger","ReactComposerMemePickerDialogLoggingStore"],function(q,r){q.logMemePromptClicked();},'ReactFeedComposerXPromptInteractionsModule');this._subscriptions.addSubscriptions(c('Arbiter').subscribe('ComposerMemePickerDialog/memeSelected',function(){this.fillComposerTags(n);c('Bootloader').loadModules(["ReactComposerPromptsActions"],function(q){q.setMinutiaeData(n.composerID,n.taggerData);},'ReactFeedComposerXPromptInteractionsModule');}.bind(this)),c('Arbiter').subscribe('ComposerMemePickerDialog/dialogHidden',function(){c('CSS').hide(p);}));this._onDialogPromptCTAButtonClicked(n);return;}this.fillComposerTags(n);c('Bootloader').loadModules(["DOM","ReactComposerPromptsActions"],function(q,r){r.setMinutiaeData(n.composerID,n.taggerData);r.setPromptData(n.composerID,o);c('CSS').hide(l);c('CSS').hide(m);var s=q.scry(document,"img._3cr_")[0];if(s)c('CSS').show(s);},'ReactFeedComposerXPromptInteractionsModule');},_onDialogPromptCTAButtonClicked:function(l){var m=l.composerID,n=l.memeURLs;this._openDialog(m,n);if(!this._promptCTAButtonClicked){this._promptCTAButtonClicked=true;c('Bootloader').loadModules(["ReactComposerPromptsActions"],function(o){o.setPromptData(m,this._promptData);}.bind(this),'ReactFeedComposerXPromptInteractionsModule');this._subscriptions.addSubscriptions(c('Arbiter').subscribeOnce('ReactComposerStatusEagerAttachment/mounted',function(o,p){if(p===m)this._openDialog(m,n);}.bind(this)));}},_openDialog:function(l,m){c('Bootloader').loadModules(["ReactComposerDialogActions"],function(n){if(m)n.initMemePicker(l,m);n.setShouldShowDialog(l,true);},'ReactFeedComposerXPromptInteractionsModule');},fillComposerTags:function(l){c('requireWeak')('ReactComposerTaggerActions',function(m){c('requireWeak')('ReactComposerTaggerType',function(n){setTimeout(function(){if(l.taggerData[n.ACTIVITY])m.setTaggerData(l.composerID,n.ACTIVITY,l.taggerData[n.ACTIVITY]);if(l.taggerData[n.LOCATION])m.setTaggerData(l.composerID,n.LOCATION,l.taggerData[n.LOCATION]);c('Arbiter').inform(c('ReactComposerEvents').ACTIVATE_ATTACHMENT+l.composerID,function(){return this._cleanup(l.composerID);}.bind(this));}.bind(this),0);}.bind(this));}.bind(this));},togglePrompt:function(l,m){if(c('CSS').matchesSelector(l,"._3crz")){this.openPrompt(l,m);}else this.closePrompt(l,m);},closePrompt:function(l,m){if(!c('CSS').matchesSelector(l,"._3crz")){c('CSS').addClass(l,"_3crz");c('CSS').addClass(m,"_3cr-");this._logInteraction(c('PromptsInteractionsEventNames').IMPRESSION,j.HIDDEN);this._logInteraction(c('PromptsInteractionsEventNames').HIDE_SUGGESTION);}},openPrompt:function(l,m){c('CSS').removeClass(l,"_3crz");c('CSS').removeClass(m,"_3cr-");this._logInteraction(c('PromptsInteractionsEventNames').IMPRESSION,j.VISIBLE);this._logInteraction(c('PromptsInteractionsEventNames').SHOW_SUGGESTION);},_cleanup:function(l){this._subscriptions.release();c('requireWeak')('ReactComposerPromptsActions',function(m){setTimeout(function(){return m.setPromptData(l,null);},0);});},_logInteraction:function(l){var m=arguments.length<=1||arguments[1]===undefined?null:arguments[1];c('Bootloader').loadModules(["XReactFeedComposerXPromptDismissController","AsyncRequest"],function(n,o){var p=n.getURIBuilder().getURI();new o().setURI(p).setData({user_action:l,prompt_id:this._promptData.promptID,prompt_type:this._promptData.promptType,prompt_tracking_string:this._promptData.trackingString,prompt_state:m}).send();}.bind(this),'ReactFeedComposerXPromptInteractionsModule');}};f.exports=k;},null);